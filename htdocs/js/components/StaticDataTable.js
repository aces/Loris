!function(e){function t(r){if(a[r])return a[r].exports;var s=a[r]={exports:{},id:r,loaded:!1};return e[r].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=React.createClass({displayName:"StaticDataTable",mixins:[React.addons.PureRenderMixin],propTypes:{Headers:React.PropTypes.array.isRequired,Data:React.PropTypes.array.isRequired,RowNumLabel:React.PropTypes.string,getFormattedCell:React.PropTypes.func},componentDidMount:function(){jQuery.fn.DynamicTable&&(this.props.freezeColumn?$("#dynamictable").DynamicTable({freezeColumn:this.props.freezeColumn}):$("#dynamictable").DynamicTable());var e=JSON.parse(localStorage.getItem("modulePrefs"));null===e&&(e={}),void 0===e[loris.TestName]&&(e[loris.TestName]={},e[loris.TestName].rowsPerPage=this.state.RowsPerPage);var t=e[loris.TestName].rowsPerPage;this.setState({RowsPerPage:t}),this.modulePrefs=e},componentDidUpdate:function(){jQuery.fn.DynamicTable&&(this.props.freezeColumn?$("#dynamictable").DynamicTable({freezeColumn:this.props.freezeColumn}):$("#dynamictable").DynamicTable())},getInitialState:function(){return{PageNumber:1,SortColumn:-1,SortOrder:"ASC",RowsPerPage:20}},getDefaultProps:function(){return{Headers:[],Data:{},RowNumLabel:"No.",Filter:{}}},changePage:function(e){this.setState({PageNumber:e})},setSortColumn:function(e){var t=this;return function(a){t.state.SortColumn===e?t.setState({SortOrder:"ASC"===t.state.SortOrder?"DESC":"ASC"}):t.setState({SortColumn:e})}},changeRowsPerPage:function(e){var t=e.target.value,a=this.modulePrefs;a[loris.TestName].rowsPerPage=t,localStorage.setItem("modulePrefs",JSON.stringify(a)),this.setState({RowsPerPage:t,PageNumber:1})},downloadCSV:function(e){var t=new Worker(loris.BaseURL+"/js/workers/savecsv.js");t.addEventListener("message",function(e){var t,a,r;"SaveCSV"===e.data.cmd&&(a=(new Date).toISOString(),t=window.URL.createObjectURL(e.data.message),r=document.createElement("a"),r.download="data-"+a+".csv",r.type="text/csv",r.href=t,document.body.appendChild(r),$(r)[0].click(),document.body.removeChild(r))}),t.postMessage({cmd:"SaveFile",data:e,headers:this.props.Headers,identifiers:this.props.RowNameMap})},countFilteredRows:function(){for(var e=0,t=this.props.Filter?Object.keys(this.props.Filter).length:0,a=this.props.Data,r=this.props.Headers,s=0;s<a.length;s++){for(var o=0,n=0;n<r.length;n++){var l=a[s]?a[s][n]:null;this.hasFilterKeyword(r[n],l)&&o++}o===t&&e++}var i=0!==t;return 0===e&&i?0:0===e?a.length:e},toCamelCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(e,t){return 0===Number(e)?"":0===t?e.toLowerCase():e.toUpperCase()})},hasFilterKeyword:function(e,t){var a=this.toCamelCase(e),r=null,s=!1;if(this.props.Filter[a]&&(r=this.props.Filter[a].value,s=this.props.Filter[a].exactMatch),null===r||null===t)return!1;if("number"==typeof r){var o=Number.parseInt(t,10);return r===o}if("string"==typeof r){var n=r.toLowerCase(),l=t.toLowerCase();return s?l===n:l.indexOf(n)>-1}return!1},render:function(){if(null===this.props.Data||0===this.props.Data.length)return React.createElement("div",{className:"alert alert-info no-result-found-panel"},React.createElement("strong",null,"No result found."));for(var e=this.state.RowsPerPage,t=[React.createElement("th",{key:"th_col_0",onClick:this.setSortColumn(-1)},this.props.RowNumLabel)],a=0;a<this.props.Headers.length;a+=1)if("undefined"==typeof loris.hiddenHeaders||loris.hiddenHeaders.indexOf(this.props.Headers[a])===-1){var r=a+1;this.props.Headers[a]===this.props.freezeColumn?t.push(React.createElement("th",{key:"th_col_"+r,id:this.props.freezeColumn,onClick:this.setSortColumn(a)},this.props.Headers[a])):t.push(React.createElement("th",{key:"th_col_"+r,onClick:this.setSortColumn(a)},this.props.Headers[a]))}for(var s=[],o=[],n=[],l=this,i=0;i<this.props.Data.length;i+=1){var c=this.props.Data[i][this.state.SortColumn];parseInt(c,10)===c?c=parseInt(c,10):parseFloat(c)===c?c=parseFloat(c):"."===c&&(c=null);var p="string"==typeof c||c instanceof String;void 0!==c&&p&&(c=c.toLowerCase()),this.props.RowNameMap?n.push({RowIdx:i,Value:c,Content:this.props.RowNameMap[i]}):n.push({RowIdx:i,Value:c,Content:i+1})}n.sort(function(e,t){if("ASC"===l.state.SortOrder){if(null===e.Value)return-1;if(null===t.Value)return 1;if(e.Value<t.Value)return-1;if(e.Value>t.Value)return 1;if(e.RowIdx<t.RowIdx)return-1;if(e.RowIdx>t.RowIdx)return 1}else{if(null===e.Value)return 1;if(null===t.Value)return-1;if(e.Value<t.Value)return 1;if(e.Value>t.Value)return-1;if(e.RowIdx<t.RowIdx)return 1;if(e.RowIdx>t.RowIdx)return-1}return 0});for(var u=0,d=this.countFilteredRows(),m=e*(this.state.PageNumber-1),h=[],f=0;f<this.props.Data.length&&s.length<e;f++){o=[];for(var R=0,g=0;g<this.props.Headers.length;g+=1){var w="Unknown";this.props.Data[n[f].RowIdx]&&(w=this.props.Data[n[f].RowIdx][g]),this.hasFilterKeyword(this.props.Headers[g],w)&&(R++,h.push(this.props.Data[n[f].RowIdx]));var v="td_col_"+g;this.props.getFormattedCell?(w=this.props.getFormattedCell(this.props.Headers[g],w,this.props.Data[n[f].RowIdx],this.props.Headers),null!==w&&o.push(React.addons.createFragment({data:w}))):o.push(React.createElement("td",{key:v},w))}if(Object.keys(this.props.Filter).length===R&&(u++,u>m)){var C=n[f].Content;s.push(React.createElement("tr",{key:"tr_"+C,colSpan:t.length},React.createElement("td",null,C),o))}}var P=React.createElement("select",{className:"input-sm perPage",onChange:this.changeRowsPerPage,value:this.state.RowsPerPage},React.createElement("option",null,"20"),React.createElement("option",null,"50"),React.createElement("option",null,"100"),React.createElement("option",null,"1000"),React.createElement("option",null,"5000"),React.createElement("option",null,"10000")),b=this.props.Data;return this.props.Filter&&h.length>0&&(b=h),React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"table-header panel-heading"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},s.length," rows displayed of ",d,". (Maximum rows per page: ",P,")",React.createElement("div",{className:"pull-right"},React.createElement(PaginationLinks,{Total:d,onChangePage:this.changePage,RowsPerPage:e,Active:this.state.PageNumber}))))),React.createElement("table",{className:"table table-hover table-primary table-bordered",id:"dynamictable"},React.createElement("thead",null,React.createElement("tr",{className:"info"},t)),React.createElement("tbody",null,s)),React.createElement("div",{className:"panel-footer table-footer"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("div",{className:"col-xs-12 footerText"},s.length," rows displayed of ",d,". (Maximum rows per page: ",P,")"),React.createElement("div",{className:"col-xs-6"},React.createElement("button",{className:"btn btn-primary downloadCSV",onClick:this.downloadCSV.bind(null,b)},"Download Table as CSV")),React.createElement("div",{className:"pull-right"},React.createElement(PaginationLinks,{Total:d,onChangePage:this.changePage,RowsPerPage:e,Active:this.state.PageNumber}))))))}}),r=React.createFactory(a);window.StaticDataTable=a,window.RStaticDataTable=r,t.default=a}]);
//# sourceMappingURL=StaticDataTable.js.map