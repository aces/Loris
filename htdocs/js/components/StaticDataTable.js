!function(e){function t(r){if(a[r])return a[r].exports;var o=a[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=React.createClass({displayName:"StaticDataTable",mixins:[React.addons.PureRenderMixin],propTypes:{Headers:React.PropTypes.array.isRequired,Data:React.PropTypes.array.isRequired,RowNumLabel:React.PropTypes.string,getFormattedCell:React.PropTypes.func},componentDidMount:function(){jQuery.fn.DynamicTable&&(this.props.freezeColumn?$("#dynamictable").DynamicTable({freezeColumn:this.props.freezeColumn}):$("#dynamictable").DynamicTable());var e=JSON.parse(localStorage.getItem("modulePrefs"));null===e&&(e={}),void 0===e[loris.TestName]&&(e[loris.TestName]={},e[loris.TestName].rowsPerPage=this.state.RowsPerPage);var t=e[loris.TestName].rowsPerPage;this.setState({RowsPerPage:t}),this.modulePrefs=e},componentDidUpdate:function(){jQuery.fn.DynamicTable&&(this.props.freezeColumn?$("#dynamictable").DynamicTable({freezeColumn:this.props.freezeColumn}):$("#dynamictable").DynamicTable())},getInitialState:function(){return{PageNumber:1,SortColumn:-1,SortOrder:"ASC",RowsPerPage:20}},getDefaultProps:function(){return{Headers:[],Data:{},RowNumLabel:"No.",Filter:{}}},changePage:function(e){this.setState({PageNumber:e})},setSortColumn:function(e){var t=this;return function(a){t.state.SortColumn===e?t.setState({SortOrder:"ASC"===t.state.SortOrder?"DESC":"ASC"}):t.setState({SortColumn:e})}},changeRowsPerPage:function(e){var t=e.target.value,a=this.modulePrefs;a[loris.TestName].rowsPerPage=t,localStorage.setItem("modulePrefs",JSON.stringify(a)),this.setState({RowsPerPage:t,PageNumber:1})},downloadCSV:function(e){var t=new Worker(loris.BaseURL+"/js/workers/savecsv.js");t.addEventListener("message",function(e){var t,a,r;"SaveCSV"===e.data.cmd&&(a=(new Date).toISOString(),t=window.URL.createObjectURL(e.data.message),r=document.createElement("a"),r.download="data-"+a+".csv",r.type="text/csv",r.href=t,document.body.appendChild(r),$(r)[0].click(),document.body.removeChild(r))}),t.postMessage({cmd:"SaveFile",data:e,headers:this.props.Headers,identifiers:this.props.RowNameMap})},countFilteredRows:function(){for(var e=0,t=this.props.Filter?Object.keys(this.props.Filter).length:0,a=this.props.Data,r=this.props.Headers,o=0;o<a.length;o++){for(var s=0,n=0;n<r.length;n++){var l=a[o]?a[o][n]:null;this.hasFilterKeyword(r[n],l)&&s++}s===t&&e++}var i=0!==t;return 0===e&&i?0:0===e?a.length:e},toCamelCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(e,t){return 0===Number(e)?"":0===t?e.toLowerCase():e.toUpperCase()})},sortTableRows:function(){for(var e=[],t=0;t<this.props.Data.length;t+=1){var r=this.props.Data[t][this.state.SortColumn]||void 0,o="string"==typeof r||r instanceof String,s=!isNaN(r)&&"object"!==("undefined"==typeof r?"undefined":a(r));r="."===r?null:s?Number(r):o?r.toLowerCase():void 0,this.props.RowNameMap?e.push({RowIdx:t,Value:r,Content:this.props.RowNameMap[t]}):e.push({RowIdx:t,Value:r,Content:t+1})}return e.sort(function(e,t){if("ASC"===this.state.SortOrder){if(null===e.Value)return-1;if(null===t.Value)return 1;if(e.Value<t.Value)return-1;if(e.Value>t.Value)return 1;if(e.RowIdx<t.RowIdx)return-1;if(e.RowIdx>t.RowIdx)return 1}else{if(null===e.Value)return 1;if(null===t.Value)return-1;if(e.Value<t.Value)return 1;if(e.Value>t.Value)return-1;if(e.RowIdx<t.RowIdx)return 1;if(e.RowIdx>t.RowIdx)return-1}return 0}.bind(this)),e},hasFilterKeyword:function(e,t){var a=this.toCamelCase(e),r=null,o=!1;if(this.props.Filter[a]&&(r=this.props.Filter[a].value,o=this.props.Filter[a].exactMatch),null===r||null===t)return!1;if("number"==typeof r){var s=Number.parseInt(t,10);return r===s}if("string"==typeof r){var n=r.toLowerCase(),l=t.toLowerCase();return o?l===n:l.indexOf(n)>-1}return!1},render:function(){if(null===this.props.Data||0===this.props.Data.length)return React.createElement("div",{className:"alert alert-info no-result-found-panel"},React.createElement("strong",null,"No result found."));for(var e=this.state.RowsPerPage,t=[React.createElement("th",{key:"th_col_0",onClick:this.setSortColumn(-1)},this.props.RowNumLabel)],a=0;a<this.props.Headers.length;a+=1)if("undefined"==typeof loris.hiddenHeaders||loris.hiddenHeaders.indexOf(this.props.Headers[a])===-1){var r=a+1;this.props.Headers[a]===this.props.freezeColumn?t.push(React.createElement("th",{key:"th_col_"+r,id:this.props.freezeColumn,onClick:this.setSortColumn(a)},this.props.Headers[a])):t.push(React.createElement("th",{key:"th_col_"+r,onClick:this.setSortColumn(a)},this.props.Headers[a]))}for(var o=[],s=[],n=this.sortTableRows(),l=0,i=this.countFilteredRows(),c=e*(this.state.PageNumber-1),u=[],p=0;p<this.props.Data.length&&o.length<e;p++){s=[];for(var d=0,m=0;m<this.props.Headers.length;m+=1){var h="Unknown";this.props.Data[n[p].RowIdx]&&(h=this.props.Data[n[p].RowIdx][m]),this.hasFilterKeyword(this.props.Headers[m],h)&&(d++,u.push(this.props.Data[n[p].RowIdx]));var f="td_col_"+m;this.props.getFormattedCell?(h=this.props.getFormattedCell(this.props.Headers[m],h,this.props.Data[n[p].RowIdx],this.props.Headers),null!==h&&s.push(React.addons.createFragment({data:h}))):s.push(React.createElement("td",{key:f},h))}if(Object.keys(this.props.Filter).length===d&&(l++,l>c)){var R=n[p].Content;o.push(React.createElement("tr",{key:"tr_"+R,colSpan:t.length},React.createElement("td",null,R),s))}}var g=React.createElement("select",{className:"input-sm perPage",onChange:this.changeRowsPerPage,value:this.state.RowsPerPage},React.createElement("option",null,"20"),React.createElement("option",null,"50"),React.createElement("option",null,"100"),React.createElement("option",null,"1000"),React.createElement("option",null,"5000"),React.createElement("option",null,"10000")),w=this.props.Data;return this.props.Filter&&u.length>0&&(w=u),React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"table-header panel-heading"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},o.length," rows displayed of ",i,". (Maximum rows per page: ",g,")",React.createElement("div",{className:"pull-right"},React.createElement(PaginationLinks,{Total:i,onChangePage:this.changePage,RowsPerPage:e,Active:this.state.PageNumber}))))),React.createElement("table",{className:"table table-hover table-primary table-bordered",id:"dynamictable"},React.createElement("thead",null,React.createElement("tr",{className:"info"},t)),React.createElement("tbody",null,o)),React.createElement("div",{className:"panel-footer table-footer"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("div",{className:"col-xs-12 footerText"},o.length," rows displayed of ",i,". (Maximum rows per page: ",g,")"),React.createElement("div",{className:"col-xs-6"},React.createElement("button",{className:"btn btn-primary downloadCSV",onClick:this.downloadCSV.bind(null,w)},"Download Table as CSV")),React.createElement("div",{className:"pull-right"},React.createElement(PaginationLinks,{Total:i,onChangePage:this.changePage,RowsPerPage:e,Active:this.state.PageNumber}))))))}}),o=React.createFactory(r);window.StaticDataTable=r,window.RStaticDataTable=o,t.default=r}]);
//# sourceMappingURL=StaticDataTable.js.map