!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ParticipantStatus=React.createClass({displayName:"ParticipantStatus",getInitialState:function(){return{Data:[],formData:{},updateResult:null,errorMessage:null,isLoaded:!1,loadedData:0}},componentDidMount:function(){var that=this;$.ajax(this.props.dataURL,{dataType:"json",xhr:function xhr(){var xhr=new window.XMLHttpRequest;return xhr.addEventListener("progress",function(evt){that.setState({loadedData:evt.loaded})}),xhr},success:function(data){var formData={};formData.participantStatus=data.participantStatus,formData.participantSuboptions=data.participantSuboptions,formData.reasonSpecify=data.reasonSpecify,that.setState({Data:data,formData:formData,isLoaded:!0})},error:function(data,errorCode,errorMsg){that.setState({error:"An error occurred when loading the form!"})}})},setFormData:function(formElement,value){var formData=this.state.formData,required=this.state.Data.required;"participantStatus"===formElement&&required.indexOf(value)<0&&(formData.participantSuboptions=""),formData[formElement]=value,this.setState({formData:formData})},onSubmit:function(e){e.preventDefault()},render:function(){if(!this.state.isLoaded)return void 0!==this.state.error?React.createElement("div",{className:"alert alert-danger text-center"},React.createElement("strong",null,this.state.error)):React.createElement("button",{className:"btn-info has-spinner"},"Loading",React.createElement("span",{className:"glyphicon glyphicon-refresh glyphicon-refresh-animate"}));var disabled=!0,updateButton=null;loris.userHasPermission("candidate_parameter_edit")&&(disabled=!1,updateButton=React.createElement(ButtonElement,{label:"Update"}));var required=this.state.Data.required,subOptions=[],suboptionsRequired=!1,participantStatus=this.state.formData.participantStatus?this.state.formData.participantStatus:this.state.Data.participantStatus;participantStatus&&required.indexOf(participantStatus)>-1&&(subOptions=this.state.Data.parentIDs[participantStatus],suboptionsRequired=!0);var formattedHistory=[];for(var statusKey in this.state.Data.history)if(this.state.Data.history.hasOwnProperty(statusKey)){var line="";for(var field in this.state.Data.history[statusKey])if(this.state.Data.history[statusKey].hasOwnProperty(field)){var current=this.state.Data.history[statusKey][field];if(null!==current)switch(field){case"data_entry_date":line+="[",line+=current,line+="] ";break;case"entry_staff":line+=current,line+=" ";break;case"status":line+=" Status: ",line+=current,line+=" ";break;case"suboption":line+="Details: ",line+=current,line+=" ";break;case"reason_specify":line+="Comments: ",line+=current,line+=" "}}formattedHistory.push(React.createElement("p",null,line))}var alertMessage="",alertClass="alert text-center hide";if(this.state.updateResult)if("success"===this.state.updateResult)alertClass="alert alert-success text-center",alertMessage="Update Successful!";else if("error"===this.state.updateResult){var errorMessage=this.state.errorMessage;alertClass="alert alert-danger text-center",alertMessage=errorMessage?errorMessage:"Failed to update!"}return React.createElement("div",{class:"row"},React.createElement("div",{className:alertClass,role:"alert",ref:"alert-message"},alertMessage),React.createElement(FormElement,{name:"participantStatus",onSubmit:this.handleSubmit,ref:"form",class:"col-md-6"},React.createElement(StaticElement,{label:"PSCID",text:this.state.Data.pscid}),React.createElement(StaticElement,{label:"DCCID",text:this.state.Data.candID}),React.createElement(SelectElement,{label:"Participant Status",name:"participantStatus",options:this.state.Data.statusOptions,value:this.state.formData.participantStatus,onUserInput:this.setFormData,ref:"participantStatus",disabled:disabled,required:!0}),React.createElement(SelectElement,{label:"Specify Reason",name:"participantSuboptions",options:subOptions,value:this.state.formData.participantSuboptions,onUserInput:this.setFormData,ref:"participantSuboptions",disabled:!suboptionsRequired,required:suboptionsRequired}),React.createElement(TextareaElement,{label:"Comments",name:"reasonSpecify",value:this.state.formData.reasonSpecify,onUserInput:this.setFormData,ref:"reasonSpecify",disabled:disabled,required:!1}),updateButton,formattedHistory))},handleSubmit:function(e){e.preventDefault();var myFormData=this.state.formData,self=this,formData=new FormData;for(var key in myFormData)""!==myFormData[key]&&formData.append(key,myFormData[key]);formData.append("tab",this.props.tabName),formData.append("candID",this.state.Data.candID),$.ajax({type:"POST",url:self.props.action,data:formData,cache:!1,contentType:!1,processData:!1,success:function(data){self.setState({updateResult:"success"}),self.showAlertMessage()},error:function(err){if(""!==err.responseText){var errorMessage=JSON.parse(err.responseText).message;self.setState({updateResult:"error",errorMessage:errorMessage}),self.showAlertMessage()}}})},showAlertMessage:function(){var self=this;if(null!==this.refs["alert-message"]){var alertMsg=this.refs["alert-message"];$(alertMsg).fadeTo(2e3,500).delay(3e3).slideUp(500,function(){self.setState({updateResult:null})})}}}),RParticipantStatus=React.createFactory(ParticipantStatus);window.ParticipantStatus=ParticipantStatus,window.RParticipantStatus=RParticipantStatus,exports.default=ParticipantStatus}]);
//# sourceMappingURL=participantStatus.js.map