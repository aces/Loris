(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=38)})({38:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});
/**
 *  The following file contains the components used for the filter builder tab
 *
 *  @author   Jordan Stirling <jstirling91@gmail.com>
 *  @license  http://www.gnu.org/licenses/gpl-3.0.txt GPLv3
 *  @link     https://github.com/mohadesz/Loris-Trunk
 */var LogicOperator=React.createClass({displayName:"LogicOperator",changeOperator:function changeOperator(op){this.props.updateGroupOperator(op)},render:function render(){var andClass="btn",orClass="btn";if(this.props.logicOperator===1){orClass+=" btn-primary";andClass+=" switch"}else{andClass+=" btn-primary";orClass+=" switch"}return React.createElement("div",{className:"btn-group",role:"group"},React.createElement("button",{type:"button",className:andClass,onClick:this.changeOperator.bind(this,0)},"And"),React.createElement("button",{type:"button",className:orClass,onClick:this.changeOperator.bind(this,1)},"Or"))}});var FilterRule=React.createClass({displayName:"FilterRule",getInitialState:function getInitialState(){return{operators:{equal:"=",notEqual:"!=",lessThanEqual:"<=",greaterThanEqual:">=",startsWith:"startsWith",contains:"contains",isNull:"isNull",isNotNull:"isNotNull"},value:""}},componentWillMount:function componentWillMount(){this.valueSet=loris.debounce(this.valueSet,1e3)},selectInstrument:function selectInstrument(event){var rule=this.props.rule,that=this;if(event.target.value){rule.instrument=event.target.value;$.get(loris.BaseURL+"/AjaxHelper.php?Module=dataquery&script=datadictionary.php",{category:rule.instrument},function(data){rule.fields=data;that.props.updateRule(that.props.index,rule)},"json")}},fieldSelect:function fieldSelect(event){var rule=JSON.parse(JSON.stringify(this.props.rule));delete rule.field;delete rule.fieldType;delete rule.operator;delete rule.value;delete rule.visit;delete rule.candidates;if(event.target.value){rule.field=rule.fields[event.target.value].key[1];rule.fieldType=rule.fields[event.target.value].value.Type}this.props.updateRule(this.props.index,rule)},operatorSelect:function operatorSelect(event){var rule=JSON.parse(JSON.stringify(this.props.rule));delete rule.operator;delete rule.value;delete rule.visit;delete rule.candidates;if(event.target.value){rule.operator=event.target.value}this.props.updateRule(this.props.index,rule);if(rule.operator==="isNull"||rule.operator==="isNotNull"){this.setState({value:"null"});this.valueSet()}},valueChange:function valueChange(event){var rule=JSON.parse(JSON.stringify(this.props.rule));delete rule.visit;delete rule.candidates;rule.value=event.target.value;this.setState({value:event.target.value});this.valueSet();this.props.updateRule(this.props.index,rule)},valueSet:function valueSet(){var rule=JSON.parse(JSON.stringify(this.props.rule)),that=this;if(this.state.value){var responseHandler=function responseHandler(data){var i,allSessions={},allCandiates={};for(i=0;i<data.length;i++){if(!allSessions[data[i][1]]){allSessions[data[i][1]]=[]}allSessions[data[i][1]].push(data[i][0]);if(!allCandiates[data[i][0]]){allCandiates[data[i][0]]=[]}allCandiates[data[i][0]].push(data[i][1])}rule.candidates={allCandiates,allSessions};rule.session=Object.keys(allCandiates);rule.visit="All";that.props.updateSessions(that.props.index,rule)},ajaxRetrieve=function ajaxRetrieve(script){$.get(loris.BaseURL+"/AjaxHelper.php?Module=dataquery&script="+script,{category:rule.instrument,field:rule.field,value:that.state.value},responseHandler,"json")};switch(rule.operator){case"equal":case"isNull":ajaxRetrieve("queryEqual.php");break;case"notEqual":case"isNotNull":ajaxRetrieve("queryNotEqual.php");break;case"lessThanEqual":ajaxRetrieve("queryLessThanEqual.php");break;case"greaterThanEqual":ajaxRetrieve("queryGreaterThanEqual.php");break;case"startsWith":ajaxRetrieve("queryStartsWith.php");break;case"contains":ajaxRetrieve("queryContains.php");break;default:break}}},updateVisit:function updateVisit(event){var rule=JSON.parse(JSON.stringify(this.props.rule));rule.visit=event.target.value;if(event.target.value==="all"){rule.session=Object.keys(rule.candidates.allCandiates)}else{rule.session=rule.candidates.allSessions[event.target.value]}this.props.updateSessions(this.props.index,rule)},render:function render(){var rule,fieldIndex,forVisits,visits,that=this;if(this.props.rule.instrument){var fields=this.props.rule.fields.map(function(field,index){if(that.props.rule.field&&field.key[1]===that.props.rule.field){fieldIndex=index}return React.createElement("option",{value:index},field.key[1])}),operators=[],inputOptions,input,operatorKey,operatorSelect,options,value,inputType;if(this.props.rule.fieldType){inputType=this.props.rule.fieldType.split("(");operatorKey=inputType[0];for(var key in this.state.operators){operators.push(React.createElement("option",{value:key,onChange:this.operatorSelect},this.state.operators[key]))}value=this.props.rule.operator?this.props.rule.operator:"";operatorSelect=React.createElement("select",{className:"input-sm col-xs-3 ",onChange:this.operatorSelect,value},React.createElement("option",{value:""}),operators);if(this.props.rule.operator&&this.props.rule.operator!=="isNull"&&this.props.rule.operator!=="isNotNull"){switch(operatorKey){case"enum":inputOptions=enumToArray(this.props.rule.fieldType);options=inputOptions.map(function(option){return React.createElement("option",{value:option},option)});value=this.props.rule.value?this.props.rule.value:"";input=React.createElement("select",{className:"input-sm col-xs-3",onChange:this.valueChange,value},React.createElement("option",{value:""}),options);break;default:input=React.createElement("input",{type:"text",className:"input-sm col-xs-3",onChange:this.valueChange,value:this.props.rule.value});break}}if(this.props.rule.visit){visits=Object.keys(this.props.Visits).map(function(visit){return React.createElement("option",{value:visit},visit)});forVisits=React.createElement("select",{className:"input-sm col-xs-3",onChange:this.updateVisit,value:this.props.rule.visit},React.createElement("option",{value:"all"},"All Visits"),visits)}}rule=React.createElement("div",null,React.createElement("div",{className:"col-xs-12"},React.createElement("label",{className:"instrumentLabel"},this.props.rule.instrument)),React.createElement("div",{className:"col-xs-10"},React.createElement("select",{className:"input-sm col-xs-3",onChange:this.fieldSelect,value:fieldIndex},React.createElement("option",{value:""}),fields),operatorSelect,input,forVisits))}else{var options=this.props.items.map(function(item){return React.createElement("option",{value:item.category},item.category)});rule=React.createElement("select",{onChange:this.selectInstrument,className:"input-sm col-xs-10"},React.createElement("option",{value:""}),options)}return React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-body"},rule,React.createElement("div",{className:"col-xs-2"},React.createElement("button",{className:"btn btn-danger btn-sm pull-right",onClick:this.props.deleteRule.bind(this,this.props.index)},React.createElement("span",{className:"glyphicon glyphicon-remove"})," Delete"))))}});var FilterGroup=React.createClass({displayName:"FilterGroup",updateChild:function updateChild(index,child){var group=this.props.group;group.children[index]=child;if(this.props.index){this.props.updateGroup(this.props.index,group)}else{this.props.updateFilter(group)}},updateGroupOperator:function updateGroupOperator(operator){var group=this.props.group;group.activeOperator=operator;group.session=getSessions(group);if(this.props.index){this.props.updateGroup(this.props.index,group)}else{this.props.updateFilter(group)}},updateSessions:function updateSessions(index,child){var group=this.props.group,sessions=[],session=[];group.children[index]=child;group.session=getSessions(group);if(this.props.index){this.props.updateSessions(this.props.index,group)}else{this.props.updateFilter(group)}},addChild:function addChild(type){var child,group=this.props.group;if(type==="rule"){child={type:"rule"}}else{child={type:"group",activeOperator:0,children:[{type:"rule"}]}}group.children.push(child);if(this.props.index){this.props.updateGroup(this.props.index,group)}else{this.props.updateFilter(group)}},deleteChild:function deleteChild(index){var group=this.props.group;group.children.splice(index,1);group.session=getSessions(group);if(this.props.index){this.props.updateGroup(this.props.index,group)}else{this.props.updateFilter(group)}},render:function render(){var logicOperator=React.createElement(LogicOperator,{logicOperator:this.props.group.activeOperator,updateGroupOperator:this.updateGroupOperator}),that=this,children=this.props.group.children.map(function(child,index){if(child.type==="rule"){return React.createElement("li",null,React.createElement(FilterRule,{rule:child,items:that.props.items,index,updateRule:that.updateChild,updateSessions:that.updateSessions,deleteRule:that.deleteChild,Visits:that.props.Visits}))}else if(child.type==="group"){return React.createElement("li",null,React.createElement(FilterGroup,{group:child,items:that.props.items,index,updateGroup:that.updateChild,updateSessions:that.updateSessions,deleteGroup:that.deleteChild,Visits:that.props.Visits}))}}),deleteButton;if(this.props.deleteGroup){deleteButton=React.createElement("button",{className:"btn btn-danger btn-sm pull-right",onClick:this.props.deleteGroup.bind(this,this.props.index)},React.createElement("span",{className:"glyphicon glyphicon-remove"})," Delete Group")}return React.createElement("div",{className:"tree"},React.createElement("ul",{className:"firstUL"},React.createElement("li",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-2"},logicOperator),React.createElement("div",{className:"col-xs-10"},deleteButton,React.createElement("button",{className:"btn btn-primary btn-sm pull-right",onClick:this.addChild.bind(this,"group")},React.createElement("span",{className:"glyphicon glyphicon-add"})," Add Group"),React.createElement("button",{className:"btn btn-primary btn-sm pull-right",onClick:this.addChild.bind(this,"rule")},React.createElement("span",{className:"glyphicon glyphicon-add"})," Add Rule"))),React.createElement("ul",null,children))))}});var FilterBuilder=React.createClass({displayName:"FilterBuilder",render:function render(){return React.createElement("div",null,React.createElement("h1",{className:"col-xs-12"},"Filter"),React.createElement("div",{className:"col-xs-12"},React.createElement("div",{className:"well well-primary"},React.createElement(FilterGroup,{group:this.props.filter,items:this.props.items,updateFilter:this.props.updateFilter,Visits:this.props.Visits}))))}});window.LogicOperator=LogicOperator;window.FilterRule=FilterRule;window.FilterGroup=FilterGroup;window.FilterBuilder=FilterBuilder;exports.default={LogicOperator,FilterRule,FilterGroup,FilterBuilder}}});
//# sourceMappingURL=react.filterBuilder.js.map