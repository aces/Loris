!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});/**
	 *  The following file contains the components used for the field select tab
	 *
	 *  @author   Jordan Stirling <jstirling91@gmail.com>
	 *  @author   Dave MacFarlane <david.macfarlane2@mcgill.ca>
	 *  @license  http://www.gnu.org/licenses/gpl-3.0.txt GPLv3
	 *  @link     https://github.com/mohadesz/Loris-Trunk
	 */
var CategoryItem=React.createClass({displayName:"CategoryItem",render:function(){var classList="list-group-item",badge="";return this.props.selected&&(classList+=" active"),this.props.count>=0&&(badge=React.createElement("span",{className:"badge"},this.props.count)),React.createElement("a",{href:"#",className:classList,onClick:this.props.onClick},this.props.name,badge)}}),CategoryList=React.createClass({displayName:"CategoryList",getInitialState:function(){return{selectedCategory:""}},selectCategoryHandler:function(category){var that=this;return function(evt){that.props.onCategorySelect&&that.props.onCategorySelect(category),that.setState({selectedCategory:category})}},render:function(){var items=[];for(i=0;i<this.props.items.length;i+=1)selected=!1,this.props.items[i].category==this.state.selectedCategory&&(selected=!0),items.push(React.createElement(CategoryItem,{key:this.props.items[i].category,name:this.props.items[i].category,count:this.props.items[i].numFields,selected:selected,onClick:this.selectCategoryHandler(this.props.items[i].category)}));return React.createElement("div",{className:"list-group col-md-3 col-sm-12"},items)}}),FieldItem=React.createClass({displayName:"FieldItem",visitSelect:function(evt){var field={instrument:this.props.Category,field:this.props.FieldName};evt.target.checked?this.props.fieldVisitSelect("check",evt.target.value,field):this.props.fieldVisitSelect("uncheck",evt.target.value,field)},render:function(){var criteria,multiselect,classList="list-group-item row",downloadIcon="",that=this;this.props.selected&&(classList+=" active",multiselect=Object.keys(this.props.Visits).map(function(visit){var checked=!1;return that.props.selectedVisits[visit]&&(checked=!0),React.createElement("div",{class:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:visit,checked:checked,onChange:that.visitSelect})," ",visit))})),this.props.downloadable&&(downloadIcon=React.createElement("span",{className:"glyphicon glyphicon-download-alt pull-right",title:"Downloadable File"}));var displayName=this.props.FieldName;return React.createElement("div",{className:classList},React.createElement("div",{className:"col-xs-8",onClick:this.props.onClick},React.createElement("h4",{className:"list-group-item-heading col-xs-12"},displayName,criteria,downloadIcon),React.createElement("span",{className:"col-xs-12"},this.props.Description)),React.createElement("div",{className:"col-xs-4"},multiselect))}}),FieldList=React.createClass({displayName:"FieldList",onFieldClick:function(fieldName,downloadable){this.props.onFieldSelect(fieldName,this.props.category,downloadable)},render:function(){var fieldName,desc,isFile,type,selected,selectedFields,fields=[],items=this.props.items||[],rowsPerPage=this.props.FieldsPerPage||20,start=(this.props.PageNumber-1)*rowsPerPage,filter=this.props.Filter.toLowerCase();filter>0&&(start=0);for(var i=start;i<items.length&&(fieldName=items[i].key[1],desc=items[i].value.Description,type=items[i].value.Type||"varchar(255)",fieldName.toLowerCase().indexOf(filter)==-1&&desc.toLowerCase().indexOf(filter)==-1||(isFile=!1,items[i].value.IsFile&&(isFile=!0),selected=!1,this.props.selected&&this.props.selected[fieldName]&&(selected=!0),selectedFields=this.props.selected&&this.props.selected[fieldName]?this.props.selected[fieldName]:{},fields.push(React.createElement(FieldItem,{FieldName:fieldName,Category:this.props.category,Description:desc,ValueType:type,onClick:this.onFieldClick.bind(this,fieldName,isFile),selected:selected,downloadable:isFile,Visits:this.props.Visits,selectedVisits:selectedFields,fieldVisitSelect:this.props.fieldVisitSelect})),!(fields.length>rowsPerPage)));i+=1);return React.createElement("div",{className:"list-group col-md-9 col-sm-12"},fields,React.createElement(PaginationLinks,{Total:items.length,Active:this.props.PageNumber,onChangePage:this.props.changePage,RowsPerPage:rowsPerPage}))}}),FieldSelector=React.createClass({displayName:"FieldSelector",propTypes:{selectedFields:React.PropTypes.array},getInitialState:function(){for(var instruments={},i=0;i<this.props.items.length;i++)instruments[this.props.items[i].category]=this.props.items[i].category;return{filter:"",selectedCategory:"",categoryFields:{},instruments:instruments,PageNumber:1}},onFieldSelect:function(fieldName,category,downloadable){this.props.onFieldChange(fieldName,category,downloadable)},onCategorySelect:function(elementName,category){var that=this;this.state.categoryFields[category]||$.get(loris.BaseURL+"/AjaxHelper.php?Module=dataquery&script=datadictionary.php",{category:category},function(data){var cf=that.state.categoryFields;cf[category]=data,that.setState({categoryFields:cf})},"json"),this.setState({selectedCategory:category,PageNumber:1})},filterChange:function(evt){this.setState({filter:evt.currentTarget.value})},addAll:function(){var i,isFile,fieldName,category;for(i in this.state.categoryFields[this.state.selectedCategory])fieldName=this.state.categoryFields[this.state.selectedCategory][i].key[1],category=this.state.categoryFields[this.state.selectedCategory][i].key[0],this.props.selectedFields[category]&&this.props.selectedFields[category][fieldName]||(isFile=!!this.state.categoryFields[category][i].value.isFile,this.props.onFieldChange(fieldName,category,isFile))},deleteAll:function(){var i,fieldName;for(i in this.state.categoryFields[this.state.selectedCategory])fieldName=this.state.categoryFields[this.state.selectedCategory][i].key[1],category=this.state.categoryFields[this.state.selectedCategory][i].key[0],this.props.selectedFields[category]&&this.props.selectedFields[category][fieldName]&&(isFile=!!this.state.categoryFields[category][i].value.isFile,this.props.onFieldChange(fieldName,category,isFile))},modifyCategoryFieldVists:function(visit,action){if(this.state.selectedCategory&&this.props.selectedFields[this.state.selectedCategory])for(var field in this.props.selectedFields[this.state.selectedCategory])"allVisits"!=field&&("check"!=action||this.props.selectedFields[this.state.selectedCategory][field][visit]?"uncheck"==action&&this.props.selectedFields[this.state.selectedCategory][field][visit]&&this.props.fieldVisitSelect(action,visit,{instrument:this.state.selectedCategory,field:field}):this.props.fieldVisitSelect(action,visit,{instrument:this.state.selectedCategory,field:field}))},changePage:function(i){this.setState({PageNumber:i})},render:function(){var selectedFieldsCount,categoryVisits={};if(""!=this.state.selectedCategory){this.props.selectedFields[this.state.selectedCategory]&&(selectedFieldsCount=Object.keys(this.props.selectedFields[this.state.selectedCategory]).length-1);for(var key in this.props.Visits)this.props.selectedFields[this.state.selectedCategory]&&this.props.selectedFields[this.state.selectedCategory].allVisits[key]&&this.props.selectedFields[this.state.selectedCategory].allVisits[key]==selectedFieldsCount?categoryVisits[key]=!0:categoryVisits[key]=!1}return React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("h1",{className:"col-md-8"},this.props.title),React.createElement("div",{className:"form-group col-sm-4 search"},React.createElement("label",{className:"col-sm-12 col-md-4"},"Search within instrument:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement("input",{type:"text",onChange:this.filterChange,className:"form-control input-sm"})))),React.createElement("div",{className:"row form-group"},React.createElement("div",{className:"col-md-8"},React.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.addAll},"Add All"),React.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.deleteAll},"Remove All"))),React.createElement("div",{className:"row form-group"},React.createElement("div",{className:"form-group col-sm-8 search"},React.createElement("label",{className:"col-sm-12 col-md-2"},"Instrument:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement(SearchableDropdown,{name:"fieldsDropdown",options:this.state.instruments,onUserInput:this.onCategorySelect,placeHolder:"Select One"}))),React.createElement("div",{className:"form-group col-sm-4 search"},React.createElement("label",{className:"col-sm-12 col-md-4"},"Visits:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement(SelectDropdown,{multi:!0,options:categoryVisits,onFieldClick:this.modifyCategoryFieldVists})))),React.createElement("div",{className:"row"},React.createElement(FieldList,{items:this.state.categoryFields[this.state.selectedCategory],category:this.state.selectedCategory,Criteria:this.props.Criteria,onFieldSelect:this.onFieldSelect,FieldsPerPage:"15",selected:this.props.selectedFields[this.state.selectedCategory],Filter:this.state.filter,Visits:this.props.Visits,fieldVisitSelect:this.props.fieldVisitSelect,changePage:this.changePage,PageNumber:this.state.PageNumber})))}});window.CategoryItem=CategoryItem,window.CategoryList=CategoryList,window.FieldItem=FieldItem,window.FieldList=FieldList,window.FieldSelector=FieldSelector,exports.default={CategoryItem:CategoryItem,CategoryList:CategoryList,FieldItem:FieldItem,FieldList:FieldList,FieldSelector:FieldSelector}}]);
//# sourceMappingURL=react.fieldselector.js.map