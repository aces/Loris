!function(e){function t(i){if(s[i])return s[i].exports;var a=s[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});/**
	 *  The following file contains the components used for the field select tab
	 *
	 *  @author   Jordan Stirling <jstirling91@gmail.com>
	 *  @author   Dave MacFarlane <david.macfarlane2@mcgill.ca>
	 *  @license  http://www.gnu.org/licenses/gpl-3.0.txt GPLv3
	 *  @link     https://github.com/mohadesz/Loris-Trunk
	 */
var s=React.createClass({displayName:"CategoryItem",render:function(){var e="list-group-item",t="";return this.props.selected&&(e+=" active"),this.props.count>=0&&(t=React.createElement("span",{className:"badge"},this.props.count)),React.createElement("a",{href:"#",className:e,onClick:this.props.onClick},this.props.name,t)}}),a=React.createClass({displayName:"CategoryList",getInitialState:function(){return{selectedCategory:""}},selectCategoryHandler:function(e){var t=this;return function(s){t.props.onCategorySelect&&t.props.onCategorySelect(e),t.setState({selectedCategory:e})}},render:function(){var e=[];for(i=0;i<this.props.items.length;i+=1)selected=!1,this.props.items[i].category==this.state.selectedCategory&&(selected=!0),e.push(React.createElement(s,{key:this.props.items[i].category,name:this.props.items[i].category,count:this.props.items[i].numFields,selected:selected,onClick:this.selectCategoryHandler(this.props.items[i].category)}));return React.createElement("div",{className:"list-group col-md-3 col-sm-12"},e)}}),l=React.createClass({displayName:"FieldItem",visitSelect:function(e){var t={instrument:this.props.Category,field:this.props.FieldName};e.target.checked?this.props.fieldVisitSelect("check",e.target.value,t):this.props.fieldVisitSelect("uncheck",e.target.value,t)},render:function(){var e,t,s="list-group-item row",i="",a=this;this.props.selected&&(s+=" active",t=Object.keys(this.props.Visits).map(function(e){var t=!1;return a.props.selectedVisits[e]&&(t=!0),React.createElement("div",{class:"checkbox"},React.createElement("label",null,React.createElement("input",{type:"checkbox",value:e,checked:t,onChange:a.visitSelect})," ",e))})),this.props.downloadable&&(i=React.createElement("span",{className:"glyphicon glyphicon-download-alt pull-right",title:"Downloadable File"}));var l=this.props.FieldName;return React.createElement("div",{className:s},React.createElement("div",{className:"col-xs-8",onClick:this.props.onClick},React.createElement("h4",{className:"list-group-item-heading col-xs-12"},l,e,i),React.createElement("span",{className:"col-xs-12"},this.props.Description)),React.createElement("div",{className:"col-xs-4"},t))}}),r=React.createClass({displayName:"FieldList",getInitialState:function(){return{PageNumber:1}},onFieldClick:function(e,t){this.props.onFieldSelect(e,this.props.category,t)},changePage:function(e){this.setState({PageNumber:e})},render:function(){var e,t,s,i,a=[],r=this.props.items||[],c=this.props.FieldsPerPage||20,o=(this.state.PageNumber-1)*c,n=this.props.Filter.toLowerCase();n>0&&(o=0);for(var d=o;d<r.length&&(e=r[d].key[1],t=r[d].value.Description,type=r[d].value.Type||"varchar(255)",e.toLowerCase().indexOf(n)==-1&&t.toLowerCase().indexOf(n)==-1||(s=!1,r[d].value.IsFile&&(s=!0),selected=!1,this.props.selected&&this.props.selected[e]&&(selected=!0),i=this.props.selected&&this.props.selected[e]?this.props.selected[e]:{},a.push(React.createElement(l,{FieldName:e,Category:this.props.category,Description:t,ValueType:type,onClick:this.onFieldClick.bind(this,e,s),selected:selected,downloadable:s,Visits:this.props.Visits,selectedVisits:i,fieldVisitSelect:this.props.fieldVisitSelect})),!(a.length>c)));d+=1);return React.createElement("div",{className:"list-group col-md-9 col-sm-12"},a,React.createElement(PaginationLinks,{Total:r.length,Active:this.state.PageNumber,onChangePage:this.changePage,RowsPerPage:c}))}}),c=React.createClass({displayName:"FieldSelector",propTypes:{selectedFields:React.PropTypes.array},getInitialState:function(){for(var e={},t=0;t<this.props.items.length;t++)e[this.props.items[t].category]=this.props.items[t].category;return{filter:"",selectedCategory:"",categoryFields:{},instruments:e}},onFieldSelect:function(e,t,s){this.props.onFieldChange(e,t,s)},onCategorySelect:function(e){var t=this;this.state.categoryFields[e]||$.get(loris.BaseURL+"/AjaxHelper.php?Module=dataquery&script=datadictionary.php",{category:e},function(s){var i=t.state.categoryFields;i[e]=s,t.setState({categoryFields:i})},"json"),this.setState({selectedCategory:e})},filterChange:function(e){this.setState({filter:e.currentTarget.value})},addAll:function(){var e,t,s,i;for(e in this.state.categoryFields[this.state.selectedCategory])s=this.state.categoryFields[this.state.selectedCategory][e].key[1],i=this.state.categoryFields[this.state.selectedCategory][e].key[0],this.props.selectedFields[i]&&this.props.selectedFields[i][s]||(t=!!this.state.categoryFields[i][e].value.isFile,this.props.onFieldChange(s,i,t))},deleteAll:function(){var e,t;for(e in this.state.categoryFields[this.state.selectedCategory])t=this.state.categoryFields[this.state.selectedCategory][e].key[1],category=this.state.categoryFields[this.state.selectedCategory][e].key[0],this.props.selectedFields[category]&&this.props.selectedFields[category][t]&&(isFile=!!this.state.categoryFields[category][e].value.isFile,this.props.onFieldChange(t,category,isFile))},modifyCategoryFieldVists:function(e,t){if(this.state.selectedCategory&&this.props.selectedFields[this.state.selectedCategory])for(var s in this.props.selectedFields[this.state.selectedCategory])"allVisits"!=s&&("check"!=t||this.props.selectedFields[this.state.selectedCategory][s][e]?"uncheck"==t&&this.props.selectedFields[this.state.selectedCategory][s][e]&&this.props.fieldVisitSelect(t,e,{instrument:this.state.selectedCategory,field:s}):this.props.fieldVisitSelect(t,e,{instrument:this.state.selectedCategory,field:s}))},render:function(){var e,t={};if(""!=this.state.selectedCategory){this.props.selectedFields[this.state.selectedCategory]&&(e=Object.keys(this.props.selectedFields[this.state.selectedCategory]).length-1);for(var s in this.props.Visits)this.props.selectedFields[this.state.selectedCategory]&&this.props.selectedFields[this.state.selectedCategory].allVisits[s]&&this.props.selectedFields[this.state.selectedCategory].allVisits[s]==e?t[s]=!0:t[s]=!1}return React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("h1",{className:"col-md-8"},this.props.title),React.createElement("div",{className:"form-group col-sm-4 search"},React.createElement("label",{className:"col-sm-12 col-md-4"},"Search within instrument:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement("input",{type:"text",onChange:this.filterChange,className:"form-control input-sm"})))),React.createElement("div",{className:"row form-group"},React.createElement("div",{className:"col-md-8"},React.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.addAll},"Add All"),React.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.deleteAll},"Remove All"))),React.createElement("div",{className:"row form-group"},React.createElement("div",{className:"form-group col-sm-8 search"},React.createElement("label",{className:"col-sm-12 col-md-2"},"Instrument:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement(SelectDropdown,{multi:!1,options:this.state.instruments,onFieldClick:this.onCategorySelect,selectedCategory:this.state.selectedCategory}))),React.createElement("div",{className:"form-group col-sm-4 search"},React.createElement("label",{className:"col-sm-12 col-md-4"},"Visits:"),React.createElement("div",{className:"col-sm-12 col-md-8"},React.createElement(SelectDropdown,{multi:!0,options:t,onFieldClick:this.modifyCategoryFieldVists})))),React.createElement("div",{className:"row"},React.createElement(r,{items:this.state.categoryFields[this.state.selectedCategory],category:this.state.selectedCategory,Criteria:this.props.Criteria,onFieldSelect:this.onFieldSelect,FieldsPerPage:"15",selected:this.props.selectedFields[this.state.selectedCategory],Filter:this.state.filter,Visits:this.props.Visits,fieldVisitSelect:this.props.fieldVisitSelect})))}});window.CategoryItem=s,window.CategoryList=a,window.FieldItem=l,window.FieldList=r,window.FieldSelector=c,t.default={CategoryItem:s,CategoryList:a,FieldItem:l,FieldList:r,FieldSelector:c}}]);
//# sourceMappingURL=react.fieldselector.js.map