!function(e){function t(s){if(a[s])return a[s].exports;var n=a[s]={exports:{},id:s,loaded:!1};return e[s].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=React.createClass({displayName:"SliderPanel",render:function(){return React.createElement("div",{className:"panel-group",id:"bvl_feedback_menu"},React.createElement("div",{className:"breadcrumb-panel"},React.createElement("a",{className:"info"},"Feedback for PSCID: ",this.props.pscid)),this.props.children)}}),s=React.createClass({displayName:"FeedbackPanelContent",propTypes:{feedbackLevel:React.PropTypes.string.isRequired},getInitialState:function(){return{currentEntryToggled:null}},markCommentToggle:function(e){e===this.state.currentEntryToggled?this.setState({currentEntryToggled:null}):this.setState({currentEntryToggled:e})},openThread:function(e){this.props.open_thread(e)},closeThread:function(e){this.props.close_thread(e),this.setState({currentEntryToggled:null})},render:function(){var e=["Type","Author","Status"];"instrument"===this.props.feedbackLevel&&(e[0]="Fieldname");var t=React.createElement("tr",{className:"info"},e.map(function(e,t){return React.createElement("td",{key:t},e)}));if(this.props.threads.length){var a=this.state.currentEntryToggled,s=this.props.threads.map(function(e,t){var s=a===t;return React.createElement(n,{key:e.FeedbackID,commentToggled:s,feedbackID:e.FeedbackID,sessionID:this.props.sessionID,type:e.Type,commentID:this.props.commentID,candID:this.props.candID,status:e.QCStatus,date:e.Date,commentToggle:this.markCommentToggle.bind(null,t),fieldname:e.FieldName,author:e.User,onClickClose:this.closeThread.bind(null,t),onClickOpen:this.props.open_thread.bind(null,t)})}.bind(this)),r=React.createElement("table",{id:"current_thread_table",className:"table table-hover table-bordered dynamictable"},React.createElement("thead",{id:"current_thread_table_header"},t),s);return React.createElement("div",{className:"panel-collapse collapse in"},React.createElement("div",{className:"panel-body"},r))}return React.createElement("div",{className:"panel-body"},"There are no threads for this user!")}}),n=React.createClass({displayName:"FeedbackPanelRow",getInitialState:function(){return{threadEntriesToggled:!1,threadEntriesLoaded:[]}},componentDidMount:function(){this.loadServerState()},loadServerState:function(){var e=this;$.ajax({type:"GET",url:loris.BaseURL+"/bvl_feedback/ajax/get_thread_entry_data.php",data:{feedbackID:this.props.feedbackID},success:function(t){e.setState({threadEntriesLoaded:t})},error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},toggleEntries:function(e){var t=!1;t=!!e||!this.state.threadEntriesToggled,this.setState({threadEntriesToggled:t})},newThreadEntry:function(e){var t=this.props.feedbackID,a=this.props.candID;$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/thread_comment_bvl_feedback.php",data:{comment:e,feedbackID:t,candID:a},success:function(e){this.loadServerState()}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},render:function(){var e="glyphicon glyphicon-chevron-right glyphs",t=[],a="closed",s="btn btn-success dropdown-toggle btn-sm",n=React.createElement("li",null,React.createElement("a",{onClick:this.props.onClickOpen},"Open")),l=void 0;return this.state.threadEntriesToggled&&(e="glyphicon glyphicon-chevron-down glyphs",t=this.state.threadEntriesLoaded.map(function(e,t){return React.createElement("tr",{key:t,className:"thread_entry"},React.createElement("td",{colSpan:"100%"},e.UserID," on ",e.TestDate," commented:",React.createElement("br",null),e.Comment))})),"opened"===this.props.status&&(a="opened",s="btn btn-danger dropdown-toggle btn-sm",n=React.createElement("li",null,React.createElement("a",{onClick:this.props.onClickClose},"Close")),l=React.createElement("span",{className:"glyphicon glyphicon-pencil",onClick:this.props.commentToggle})),React.createElement("tbody",null,React.createElement("tr",null,this.props.fieldname?React.createElement("td",null,this.props.fieldname,React.createElement("br",null),this.props.type):React.createElement("td",null,this.props.type),React.createElement("td",null,this.props.author," on:",React.createElement("br",null),this.props.date),React.createElement("td",null,React.createElement("div",{className:"btn-group"},React.createElement("button",{name:"thread_button",type:"button",className:s,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},a,React.createElement("span",{className:"caret"})),React.createElement("ul",{className:"dropdown-menu"},n)),React.createElement("span",{className:e,onClick:this.toggleEntries.bind(this,!1)}),l)),this.props.commentToggled?React.createElement(r,{user:this.props.user,onCommentSend:this.newThreadEntry,toggleThisThread:this.toggleEntries.bind(this,!0)}):null,t)}}),r=React.createClass({displayName:"CommentEntryForm",getInitialState:function(){return{value:""}},sendComment:function(){this.props.onCommentSend(this.state.value),this.setState({value:"Comment added!"}),this.props.toggleThisThread()},handleChange:function(e){this.setState({value:e.target.value})},render:function(){return React.createElement("tr",null,React.createElement("td",{colSpan:"100%"},"Add a thread entry:",React.createElement("div",{className:"input-group",style:{width:"100%"}},React.createElement("textarea",{className:"form-control",value:this.state.value,style:{resize:"none"},rows:"2",ref:"threadEntry",onChange:this.handleChange}),React.createElement("span",{className:"input-group-addon btn btn-primary",onClick:this.sendComment},"Send"))))}}),l=React.createClass({displayName:"AccordionPanel",getInitialState:function(){return{toggled:!1}},toggleChange:function(){this.setState({toggled:!this.state.toggled})},render:function(){var e="panel-collapse collapse in",t=void 0;return this.state.toggled&&(e="panel-collapse collapse",t="collapsed"),React.createElement("div",{className:"panel-group",id:"accordion"},React.createElement("div",{className:"panel panel-default"},React.createElement("div",{className:"panel-heading"},React.createElement("h4",{className:"panel-title"},React.createElement("a",{className:t,onClick:this.toggleChange},this.props.title))),React.createElement("div",{className:e},this.props.children)))}}),c=React.createClass({displayName:"NewThreadPanel",propTypes:{selectOptions:React.PropTypes.object},getInitialState:function(){return{textValue:"",selectValue:"Across All Fields",inputValue:1}},handleSelectChange:function(e){this.setState({selectValue:e.target.value})},handleTextChange:function(e){this.setState({textValue:e.target.value})},handleInputChange:function(e){this.setState({inputValue:e.target.value})},createNewThread:function(){this.state.textValue.length&&$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/new_bvl_feedback.php",data:{inputType:this.state.inputValue,fieldName:this.state.selectValue,comment:this.state.textValue,candID:this.props.candID,sessionID:this.props.sessionID,commentID:this.props.commentID,user:this.props.commentID},success:function(e){this.setState({textValue:"The new thread has been submitted!"}),this.props.addThread(e),this.props.updateSummaryThread()}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},render:function(){var e,t=[];for(var a in this.props.selectOptions)this.props.selectOptions.hasOwnProperty(a)&&t.push(React.createElement("option",{key:a,value:a},this.props.selectOptions[a]));"instrument"===this.props.feedbackLevel&&(e=React.createElement("div",{className:"form-group"},React.createElement("div",{className:"row"},React.createElement("label",{className:"col-xs-4"},"Field Name"),React.createElement("div",{className:"col-xs-8"},React.createElement("select",{className:"form-control",name:"inputType",selected:this.state.selectValue,onChange:this.handleSelectChange},t)))));var s=this.props.feedbackTypes,n=[];for(var r in s)s.hasOwnProperty(r)&&n.push(React.createElement("option",{key:r,value:s[r].Type},s[r].Label));return React.createElement("div",{className:"panel-body",id:"new_feedback"},React.createElement("div",{className:"form-group"},React.createElement("textarea",{className:"form-control",rows:"4",id:"comment",value:this.state.textValue,onChange:this.handleTextChange})),e,React.createElement("div",{className:"form-group"},React.createElement("div",{className:"row"},React.createElement("label",{className:"col-xs-4"},"Feedback Type"),React.createElement("div",{className:"col-xs-8"},React.createElement("select",{name:"input",selected:this.state.inputValue,onChange:this.handleInputChange,className:"form-control"},n)))),React.createElement("div",{className:"form-group"},React.createElement("button",{id:"save_data",onClick:this.createNewThread,className:"btn btn-default pull-right btn-sm"},"Save data")))}}),o=React.createClass({displayName:"FeedbackSummaryPanel",getInitialState:function(){return{summary:null}},render:function(){var e=[];return this.props.summary_data&&(e=this.props.summary_data.map(function(e,t){return React.createElement("tr",{key:t},React.createElement("td",null,e.QC_Class),React.createElement("td",null,React.createElement("a",{href:loris.BaseURL+"/"+e.Instrument+"/?candID="+e.CandID+"&sessionID="+e.SessionID+"&commentID="+e.CommentID},e.Instrument)),React.createElement("td",null,React.createElement("a",{href:loris.BaseURL+"/instrument_list/?candID="+e.CandID+"&sessionID="+e.SessionID},e.Visit)),React.createElement("td",null,e.No_Threads))})),void 0===e||0===e.length?React.createElement("div",{className:"panel-body"},"This candidate has no behavioural feedback."):React.createElement("div",{className:"panel-body"},React.createElement("table",{className:"table table-hover table-bordered dynamictable"},React.createElement("thead",null,React.createElement("tr",{className:"info"},React.createElement("th",null,"QC Class"),React.createElement("th",null,"Instrument"),React.createElement("th",null,"Visit"),React.createElement("th",null,"# Threads"))),React.createElement("tbody",null,e)))}}),i=React.createClass({displayName:"FeedbackPanel",getInitialState:function(){return{threads:"",summary:null}},componentDidMount:function(){this.loadThreadServerState()},loadSummaryServerData:function(){$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/get_bvl_feedback_summary.php",data:{candID:this.props.candID,sessionID:this.props.sessionID,commentID:this.props.commentID},success:function(e){this.setState({summary:e})}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},loadThreadServerState:function(){$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/react_get_bvl_threads.php",data:{candID:this.props.candID,sessionID:this.props.sessionID,commentID:this.props.commentID,user:this.props.commentID},success:function(e){this.setState({threads:e}),this.loadSummaryServerData()}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},addThread:function(e){this.loadThreadServerState()},markThreadClosed:function(e){var t=this.state.threads,a=this.state.threads[e];t.splice(e,1);var s=a.FeedbackID;a.QCStatus="closed",t.push(a),$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/close_bvl_feedback_thread.php",data:{candID:this.props.candID,feedbackID:s},success:function(e){this.setState({threads:t}),this.loadSummaryServerData()}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},markThreadOpened:function(e){var t=this.state.threads,a=this.state.threads[e],s=a.FeedbackID;a.QCStatus="opened",t.splice(e,1),t.unshift(a),$.ajax({type:"POST",url:loris.BaseURL+"/bvl_feedback/ajax/open_bvl_feedback_thread.php",data:{candID:this.props.candID,feedbackID:s},success:function(e){this.setState({threads:t}),this.loadSummaryServerData()}.bind(this),error:function(e,t,a){console.error(e),console.error("Details: "+t+"\nError:"+a)}})},render:function(){var e="New "+this.props.feedbackLevel+" level feedback";return React.createElement(a,{pscid:this.props.pscid},React.createElement(l,{title:"Open Thread Summary"},React.createElement(o,{summary_data:this.state.summary})),React.createElement(l,{title:e},React.createElement(c,{selectOptions:this.props.selectOptions,feedbackLevel:this.props.feedbackLevel,candID:this.props.candID,sessionID:this.props.sessionID,commentID:this.props.commentID,addThread:this.addThread,updateSummaryThread:this.loadSummaryServerData,feedbackTypes:this.props.feedbackTypes})),React.createElement(l,{title:"Feedback Threads"},React.createElement(s,{threads:this.state.threads,close_thread:this.markThreadClosed,open_thread:this.markThreadOpened,feedbackLevel:this.props.feedbackLevel,candID:this.props.candID,sessionID:this.props.sessionID,commentID:this.props.commentID})))}}),d=React.createFactory(i);window.FeedbackPanel=i,window.RBehaviouralFeedbackPanel=d,t.default=i}]);
//# sourceMappingURL=react.behavioural_feedback_panel.js.map