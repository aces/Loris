!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),a=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={logText:"<select a row in the table below to view the upload logs>",logType:"summary"},n.initHelper=n.initHelper.bind(n),n.onLogTypeChange=n.onLogTypeChange.bind(n),n.setServerPolling=n.setServerPolling.bind(n),n.monitorProgress=n.monitorProgress.bind(n),n}return n(t,e),l(t,[{key:"componentDidMount",value:function(){this.initHelper()}},{key:"initHelper",value:function(){var e=new UploadProgress;this.uploadProgress=e,$("#mri_upload_table").on("click","tbody tr",function(t){return null!==e.getUploadRow()&&($(e.getUploadRow()).css("background-color","white"),this.setServerPolling(!1)),t.currentTarget===e.getUploadRow()?(e.setUploadRow(null),e.setProgressFromServer(null),void this.setState({logText:"<select a row in the table below to view the upload logs>"})):(e.setUploadRow(t.currentTarget),$(t.currentTarget).css("background-color","#EFEFFB"),void this.monitorProgress())}.bind(this))}},{key:"monitorProgress",value:function(){var e="Summary"===this.state.selectedLogType,t=this.uploadProgress,r=t.getUploadId();r&&$.post(loris.BaseURL+"/imaging_uploader/ajax/getUploadSummary.php",{uploadId:r,summary:e},function(e){t.setProgressFromServer(e),this.setState({logText:t.getProgressText()}),this.setServerPolling(t.getPipelineStatus()===UploadProgress.PIPELINE_STATUS_RUNNING)}.bind(this))}},{key:"setServerPolling",value:function(e){var t=this.uploadProgress;e?(this.setServerPolling.getSummaryInterval||(this.setServerPolling.getSummaryInterval=setInterval(this.monitorProgress,5e3)),this.setServerPolling.dotUpdateInterval||(this.setServerPolling.dotUpdateInterval=setInterval(function(){t.updateDots(),this.setState({logText:t.getProgressText()})},3e3)),this.setServerPolling.animatedCharInterval||(this.setServerPolling.animatedCharInterval=setInterval(function(){t.updateAnimatedCharIndex(),this.setState({logText:t.getProgressText()})},250))):(this.setServerPolling.getSummaryInterval&&(clearInterval(this.setServerPolling.getSummaryInterval),this.setServerPolling.getSummaryInterval=null),this.setServerPolling.dotUpdateInterval&&(clearInterval(this.setServerPolling.dotUpdateInterval),this.setServerPolling.dotUpdateInterval=null),this.setServerPolling.animatedCharInterval&&(clearInterval(this.setServerPolling.animatedCharInterval),this.setServerPolling.animatedCharInterval=null))}},{key:"onLogTypeChange",value:function(e,t){this.setState({logType:t}),this.monitorProgress()}},{key:"render",value:function(){var e={summary:"Summary",detailed:"Detailed"};return React.createElement(Panel,{id:"log_panel",title:"Log Viewer"},React.createElement(FormElement,{name:"log_form"},React.createElement(SelectElement,{name:"LogType",label:"Logs to display",options:e,onUserInput:this.onLogTypeChange,value:this.state.logType,emptyOption:!1}),React.createElement(TextareaElement,{name:"UploadLogs",disabled:!0,id:"mri_upload_logs",value:this.state.logText})))}}]),t}(React.Component);a.propTypes={},a.defaultProps={}}]);
//# sourceMappingURL=log_panel.js.map