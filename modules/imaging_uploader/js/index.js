!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=r(2),o=a(n);$(function(){var e=loris.BaseURL+"/imaging_uploader/?format=json",t=React.createElement(o.default,{Module:"imaging_uploader",DataURL:e}),r=document.createElement("div");r.id="page-imaging-uploader";var a=document.getElementById("lorisworkspace");a.appendChild(r),ReactDOM.render(t,document.getElementById("page-imaging-uploader"))})},,function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),s=r(3),c=a(s),u=r(4),d=a(u),p=r(5),f=a(p),m=function(e){function t(e){n(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={isLoaded:!1},r.fetchData=r.fetchData.bind(r),r}return l(t,e),i(t,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){$.ajax(this.props.DataURL,{method:"GET",dataType:"json",success:function(e){this.setState({Data:e,isLoaded:!0})}.bind(this),error:function(e){console.error(e)}})}},{key:"render",value:function(){return this.state.isLoaded?React.createElement("div",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-md-6"},React.createElement(d.default,{form:this.state.Data.form})),React.createElement("div",{className:"col-md-6"},React.createElement(c.default,null))),React.createElement("div",{id:"mri_upload_table"},React.createElement(StaticDataTable,{Data:this.state.Data.Data,Headers:this.state.Data.Headers,getFormattedCell:f.default}))):React.createElement("button",{className:"btn-info has-spinner"},"Loading",React.createElement("span",{className:"glyphicon glyphicon-refresh glyphicon-refresh-animate"}))}}]),t}(React.Component);m.propTypes={},m.defaultProps={},t.default=m},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={logText:"<select a row in the table below to view the upload logs>",logType:"summary"},n.initHelper=n.initHelper.bind(n),n.onLogTypeChange=n.onLogTypeChange.bind(n),n.setServerPolling=n.setServerPolling.bind(n),n.monitorProgress=n.monitorProgress.bind(n),n}return n(t,e),o(t,[{key:"componentDidMount",value:function(){this.initHelper()}},{key:"initHelper",value:function(){var e=new UploadProgress;this.uploadProgress=e,$("#mri_upload_table").on("click","tbody tr",function(t){return null!==e.getUploadRow()&&($(e.getUploadRow()).css("background-color","white"),this.setServerPolling(!1)),t.currentTarget===e.getUploadRow()?(e.setUploadRow(null),e.setProgressFromServer(null),void this.setState({logText:"<select a row in the table below to view the upload logs>"})):(e.setUploadRow(t.currentTarget),$(t.currentTarget).css("background-color","#EFEFFB"),void this.monitorProgress())}.bind(this))}},{key:"monitorProgress",value:function(){var e="Summary"===this.state.selectedLogType,t=this.uploadProgress,r=t.getUploadId();r&&$.post(loris.BaseURL+"/imaging_uploader/ajax/getUploadSummary.php",{uploadId:r,summary:e},function(e){t.setProgressFromServer(e),this.setState({logText:t.getProgressText()}),this.setServerPolling(t.getPipelineStatus()===UploadProgress.PIPELINE_STATUS_RUNNING)}.bind(this))}},{key:"setServerPolling",value:function(e){var t=this.uploadProgress;e?(this.setServerPolling.getSummaryInterval||(this.setServerPolling.getSummaryInterval=setInterval(this.monitorProgress,5e3)),this.setServerPolling.dotUpdateInterval||(this.setServerPolling.dotUpdateInterval=setInterval(function(){t.updateDots(),this.setState({logText:t.getProgressText()})},3e3)),this.setServerPolling.animatedCharInterval||(this.setServerPolling.animatedCharInterval=setInterval(function(){t.updateAnimatedCharIndex(),this.setState({logText:t.getProgressText()})},250))):(this.setServerPolling.getSummaryInterval&&(clearInterval(this.setServerPolling.getSummaryInterval),this.setServerPolling.getSummaryInterval=null),this.setServerPolling.dotUpdateInterval&&(clearInterval(this.setServerPolling.dotUpdateInterval),this.setServerPolling.dotUpdateInterval=null),this.setServerPolling.animatedCharInterval&&(clearInterval(this.setServerPolling.animatedCharInterval),this.setServerPolling.animatedCharInterval=null))}},{key:"onLogTypeChange",value:function(e,t){this.setState({logType:t}),this.monitorProgress()}},{key:"render",value:function(){var e={summary:"Summary",detailed:"Detailed"};return React.createElement(Panel,{id:"log_panel",title:"Log Viewer"},React.createElement(FormElement,{name:"log_form"},React.createElement(SelectElement,{name:"LogType",label:"Logs to display",options:e,onUserInput:this.onLogTypeChange,value:this.state.logType,emptyOption:!1}),React.createElement(TextareaElement,{name:"UploadLogs",disabled:!0,id:"mri_upload_logs",value:this.state.logText})))}}]),t}(React.Component);l.propTypes={},l.defaultProps={},t.default=l},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={formData:{},form:n.props.form},n.onFormChange=n.onFormChange.bind(n),n.uploadFile=n.uploadFile.bind(n),n}return n(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.state.form;e.IsPhantom.emptyOption=!1,this.setState({form:e})}},{key:"onFormChange",value:function(e,t){var r=this.state.form,a=this.state.formData;"IsPhantom"===e&&("Y"===t?(r.CandID.disabled=!0,r.PSCID.disabled=!0,r.Visit_label.disabled=!0):(r.CandID.disabled=!1,r.PSCID.disabled=!1,r.Visit_label.disabled=!1)),a[e]=t,this.setState({form:r,formData:a})}},{key:"uploadFile",value:function(){$("#file-input").hide(),$("#file-progress").removeClass("hide");var e=new FormData(this.state.formData);e.append("fire_away","Upload"),$.ajax({type:"POST",url:loris.BaseURL+"/imaging_uploader/",data:e,cache:!1,contentType:!1,processData:!1,xhr:function e(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=$("#progressbar"),r=$("#progresslabel"),a=Math.round(e.loaded/e.total*100);$(t).width(a+"%"),$(r).html(a+"%"),t.attr("aria-valuenow",a)}},!1),e},success:function(e){$("#file-progress").addClass("hide");var t={};this.setState({formData:t})}.bind(this)})}},{key:"render",value:function(){return React.createElement(Panel,{id:"upload_panel",title:"Upload a new file"},React.createElement(FormElement,{name:"upload_form",formElements:this.state.form,onUserInput:this.onFormChange},React.createElement(StaticElement,{label:"Note",text:"File name should be of type .tgz or tar.gz or .zip"}),React.createElement(ButtonElement,{onUserInput:this.uploadFile}),React.createElement("div",{id:"file-progress",className:"col-sm-9 col-sm-offset-3 hide"},React.createElement("div",{className:"progress"},React.createElement("div",{id:"progressbar",className:"progress-bar progress-bar-striped active",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"}),React.createElement("div",{id:"progresslabel"},"0%")))))}}]),t}(React.Component);l.propTypes={},l.defaultProps={},t.default=l},function(e,t){"use strict";function r(e,t,r,a){function n(e,t){loris.loadFilteredMenuClickHandler("imaging_browser",{DCCID:e})(t)}if(loris.hiddenHeaders.indexOf(e)>-1)return null;var o={};a.forEach(function(e,t){o[e]=r[t]},this);var l={whiteSpace:"nowrap"};if("Progress"===e){if("Failure"===t)return l.color="#fff",React.createElement("td",{className:"label-danger",style:l},t);if("In Progress..."===t)return l.color="#fff",React.createElement("td",{className:"label-warning",style:l},t);var i=o["Number Of MincCreated"],s=o["Number Of MincInserted"];return React.createElement("td",{style:l},t," (",s," out of ",i,")")}if("Tarchive Info"===e){var c=loris.BaseURL+"/dicom_archive/viewDetails/?tarchiveID="+t;return React.createElement("td",{style:l},React.createElement("a",{href:c},"View Details"))}return"Number Of MincInserted"===e&&t>0?React.createElement("td",{style:l},React.createElement("a",{onClick:n.bind(null,o.CandID)},t)):React.createElement("td",{style:l},t)}Object.defineProperty(t,"__esModule",{value:!0}),loris.hiddenHeaders=[],t.default=r}]);
//# sourceMappingURL=index.js.map